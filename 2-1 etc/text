First: 
Second: Hash function changed from the first code
